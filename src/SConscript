Import('env pism_libs')

env.SharedLibrary('pism', Split("""grid.cc materials.cc iceModel.cc iMbasal.cc 
iMbeddef.cc iMgrainsize.cc iMIO.cc iMIOnetcdf.cc iMmacayeal.cc iMtemp.cc iMutil.cc 
iMvelocity.cc iMviewers.cc iMdefaults.cc iMoptions.cc iMregrid.cc
extrasGSL.cc cubature.c"""))

flowTable = env.Program('flowTable', 'flowTable.cc', LIBS = ['pism'] + pism_libs)
run = env.Program('pismr', 'run.cc', LIBS = ['pism'] + pism_libs)
simplify = env.Program('pisms',
      ['iceEISModel.cc', 'iceHEINOModel.cc', 'iceROSSModel.cc', 'simplify.cc'], 
      LIBS = ['pism'] + pism_libs)
shelf = env.Program('shelf', 'shelf.cc', LIBS = ['pism'] + pism_libs)

env.SharedLibrary('tests', Split("""exact/exactTestsABCDE.c exact/exactTestsFG.c 
exact/exactTestH.c exact/exactTestI.c"""))

simpleISO = env.Program('simpleISO', 'exact/simpleISO.c', LIBS = ['tests', 'm'])
simpleFG = env.Program('simpleFG', 'exact/simpleFG.c', LIBS = ['tests', 'm'])
simpleI = env.Program('simpleI', 'exact/simpleI.c', LIBS = ['tests', 'm'])

verify = env.Program('pismv', ['iceCompModel.cc', 'verify.cc'],
                     LIBS = ['pism', 'tests'] + pism_libs)

get_drag = env.Program('get_drag.cc', LIBS= ['pism'] + pism_libs)

Default(flowTable, run, simplify, verify, simpleISO, simpleFG, simpleI, shelf, get_drag)
