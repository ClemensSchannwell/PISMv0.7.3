This directory contains all of the scripts needed to build a PISM regional
of Jakobshavn Isbrae in Greenland, or any other outlet glacier, from the
SeaRISE 1km Greenland data.  This demonstrates the outlet-glacier-mode
executable "pismo".

In order to run pismo some preprocessing must be performed.  A number
of python tools are needed.

* Get regional-tools, the drainage basin generator.  Then go to the
  newly-created "regional-tools/" directory and set up this python
  tool as directed in README.md.   Note that README.md lists the
  dependencies on python modules.  Here is the quick summary if
  all dependencies are present:

  $ cd ~
  $ git clone https://bueler@github.com/pism/regional-tools.git
  $ cd regional-tools/
  $ python setup.py install    # optionally add "--user" to build locally

* Now download and preprocess the SeaRISE data, an 80 Mb file:

  $ cd ~/pism/examples/jako/   # directory with current README
  $ ln -s ~/regional-tools/pism_regional.py .
  $ ./preprocess.sh

  A file gr1km.nc is created.  Look at what fields it contains:

  $ ncdump -h gr1km.nc
  $ ncview gr1km.nc

* Now use pism_regional.py on gr1km.nc.  It opens a graphical user interface
  (GUI) which allows you to select a small rectangle around the flux gate or
  fjord which is the terminus of the outlet glacier you want to model.

  $ python pism_regional.py

  Now select "gr1km.nc" to open.  Once the topographic map appears
  in the Figure 1 window, select the button "Select terminus rectangle".
  Now use the mouse to select the small rectangle around the Jakobshavn
  terminus, for example.  Once it is a highlighted rectangle, click
  "Compute the drainage basin mask".  Because this is a large data set
  there will be some delay.  (Note that a parallel computation is done here.)
  Finally click "Save the drainage basin mask" and save with your
  preferred name; we will assume here that it is "jakomask.nc".

  FIXME: *  selecting rectangle slow/fragile?
         *  feedback on completion of steps should appear in GUI
              not in terminal?
         *  cutout command which appears at terminal can get lost?

* The feedback from the above process includes a cutout command which
  appears as a global attribute of jakomask.nc.  Get it and use it:

  $ ncdump -h jakomask.nc |grep cutout

  Cut and paste the command, which applies to both the 1km Greenland data file
  and the mask file.  For example it will look like:

  $ ncks -d x,344,873 -d y,1015,1349 gr1km.nc jako.nc
  $ ncks -A -d x,344,873 -d y,1015,1349 jakomask.nc jako.nc

  Now look at jako.nc.  This file is ready for a regional model.  Note that
  the field ftt_mask has an identified drainage basin, outside of which we
  will not have a good model, because of the completely unmodeled exterior of
  the whole rectangle.  Outside of the ftt_mask area we will keep the original
  thickness, while inside the ftt_mask area all fields will evolve normally.

* FIXME:  need preprocess.sh to rename presartm and presprecip to use in -surface given
  mode

  5km:  vaguely like

  mpiexec -n 2 pismo -boot_file jako.nc -Mx 67 -My 106 -Mz 101 -Mbz 21 -Lz 3500 -Lbz 700 -y 1

  1km: like

  mpiexec -n 2 pismo -boot_file jako.nc -Mx 335 -My 530 -Mz 101 -Mbz 21 -Lz 3500 -Lbz 700 -y 1



FIXME from here



